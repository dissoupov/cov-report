# cov-reporter

_Generates aggregate go code coverage results._

`go test` can generate code coverage results and an overall coverage percentage, however it can
only do this one package at at time, also there are no mechanisms to exclude certain source
files from the calculation (e.g. you may want to exclude code generated files).

This tool will take one or more cover profiles generated by GO test and generate a summary
of the aggregate coverage across the set of cover profiles results. In addition you can
provide a regex to exclude files from the calculation, and get a summary of the files with
the least coverage.

## Build

If you want to manually build from source, clone the repo, and build with the standard go build tools.
You'll also need the dependency from golang.org/x/tools/cover [or the internal mirror]

`go install .`

## Usage

`cov-reporter [-fmt txt|json|xml] [-o results.file] [-u <num top uncovered files>] [-ex source file name exclusion regex] [-cc combined output filename] <coverprofileFile> ...`

e.g.

```.sh
./cov-reporter -ex "query_console|.*.pb.go" ~/code/graphr/cpt.out ~/code/graphr/cp.out
Statements
total:     2069
covered:   1856
uncovered: 213
excluded:  
result:    89.7%

Top uncovered source files [name, uncovered count, total uncovered %]
 salesforce.com/graphr/graphr.go                       92    4.4%
 salesforce.com/graphr/graph/graph.go                  40    1.9%
 salesforce.com/graphr/http/http.go                    15    0.7%
 salesforce.com/graphr/raft/transport/transport.go     15    0.7%
 salesforce.com/graphr/http/http_local.go              13    0.6%
 salesforce.com/graphr/graph/fsmversion.go             11    0.5%
 salesforce.com/graphr/graph/fsm.go                     9    0.4%
 salesforce.com/graphr/graphrctl/ctl.go                 4    0.2%
 salesforce.com/graphr/config/c.go                      4    0.2%
 salesforce.com/graphr/config/config.go                 3    0.1%

```
